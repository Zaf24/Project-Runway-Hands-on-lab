<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Step 5.3 ¬∑ Integrate Flows into Topic | GroundCrew.AI Mission Guide</title>
    <style>
        :root {
            --color-bg-main: #f3f2f1;
            --color-primary: #0078d4;
            --color-primary-dark: #005a9e;
            --color-accent-orange: #ff8c00;
            --color-deep-navy: #001f3f;
            --color-text-main: #323130;
            --color-text-muted: #605e5c;
            --radius-lg: 24px;
            --radius-md: 16px;
            --shadow-soft: 0 18px 44px rgba(0, 31, 63, 0.12);
            font-family: "Segoe UI", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: var(--color-bg-main);
            color: var(--color-text-main);
            line-height: 1.7;
            letter-spacing: 0.01em;
            padding: 0 24px 96px;
        }

        .page-shell {
            max-width: 1100px;
            margin: 0 auto;
        }

        header {
            position: sticky;
            top: 0;
            z-index: 100;
            background: rgba(243, 242, 241, 0.92);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(0, 31, 63, 0.08);
        }

        .nav {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 24px;
            padding: 16px 0;
        }

        .brand {
            display: inline-flex;
            align-items: center;
            gap: 12px;
            font-weight: 600;
            font-size: 1.1rem;
            color: var(--color-deep-navy);
            text-decoration: none;
        }

        .brand img {
            width: 40px;
            height: 40px;
            object-fit: contain;
            border-radius: 10px;
        }

        .nav-links {
            display: flex;
            gap: 14px;
        }

        .nav-links a {
            text-decoration: none;
            font-weight: 500;
            color: var(--color-text-muted);
            padding: 8px 14px;
            border-radius: 12px;
            transition: background 0.2s ease, color 0.2s ease;
        }

        .nav-links a:hover,
        .nav-links a:focus-visible {
            color: var(--color-primary);
            background: rgba(0, 120, 212, 0.12);
        }

        .hero {
            margin-top: 60px;
            padding: 48px;
            background: linear-gradient(135deg, rgba(0, 31, 63, 0.94), rgba(0, 120, 212, 0.92));
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-soft);
            color: #ffffff;
            text-align: center;
        }

        .hero h1 {
            font-size: clamp(2.2rem, 5vw, 3.2rem);
            margin-bottom: 16px;
        }

        .hero p {
            max-width: 720px;
            margin: 0 auto;
            font-size: 1.1rem;
            color: rgba(255, 255, 255, 0.86);
        }

        .stage-body {
            margin-top: 48px;
            background: #ffffff;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-soft);
            padding: 40px 44px;
            display: grid;
            gap: 36px;
        }

        .stage-section h2 {
            font-size: clamp(1.8rem, 3vw, 2.2rem);
            color: var(--color-deep-navy);
            margin-bottom: 12px;
        }

        .stage-section p {
            color: var(--color-text-muted);
            font-size: 1.05rem;
        }

        .step-card {
            background: rgba(0, 120, 212, 0.05);
            border: 1px solid rgba(0, 31, 63, 0.08);
            border-radius: var(--radius-md);
            padding: 28px;
            display: grid;
            gap: 20px;
            box-shadow: var(--shadow-soft);
        }

        .step-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
            flex-wrap: wrap;
        }

        .step-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--color-deep-navy);
        }

        .step-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 44px;
            height: 44px;
            border-radius: 12px;
            background: rgba(0, 120, 212, 0.16);
            color: var(--color-primary-dark);
            font-weight: 700;
        }

        .step-text {
            color: var(--color-text-main);
            font-size: 1.05rem;
        }

        figure {
            display: grid;
            gap: 12px;
        }

        figure img {
            width: 100%;
            border-radius: var(--radius-md);
            border: 1px solid rgba(0, 31, 63, 0.12);
            box-shadow: 0 18px 46px rgba(0, 31, 63, 0.12);
        }

        figure figcaption {
            font-size: 0.95rem;
            color: var(--color-text-muted);
            text-align: center;
        }

        .tip {
            background: rgba(0, 120, 212, 0.1);
            border-left: 4px solid var(--color-primary);
            border-radius: var(--radius-md);
            padding: 18px 20px;
            color: var(--color-text-muted);
            font-size: 0.98rem;
        }

        .warning {
            background: rgba(255, 140, 0, 0.1);
            border-left: 4px solid var(--color-accent-orange);
            border-radius: var(--radius-md);
            padding: 18px 20px;
            color: var(--color-text-main);
            font-size: 0.98rem;
            font-weight: 500;
        }

        .code-block {
            background: rgba(0, 31, 63, 0.05);
            border-left: 4px solid var(--color-primary);
            border-radius: var(--radius-md);
            padding: 18px 20px;
            font-family: "Consolas", "Monaco", monospace;
            font-size: 0.95rem;
            color: var(--color-text-main);
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .cta-panel {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            justify-content: center;
            margin-top: 12px;
        }

        .cta-button {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 14px 24px;
            border-radius: 999px;
            font-weight: 600;
            text-decoration: none;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .cta-primary {
            background: linear-gradient(135deg, rgba(0, 120, 212, 0.92), rgba(0, 90, 158, 0.94));
            color: #ffffff;
            box-shadow: 0 16px 36px rgba(0, 120, 212, 0.32);
        }

        .cta-secondary {
            background: #ffffff;
            color: var(--color-primary-dark);
            border: 1px solid rgba(0, 120, 212, 0.3);
            box-shadow: 0 12px 28px rgba(0, 31, 63, 0.14);
        }

        .cta-button:hover,
        .cta-button:focus-visible {
            transform: translateY(-2px);
            box-shadow: 0 20px 44px rgba(0, 120, 212, 0.35);
        }

        footer {
            margin-top: 72px;
            text-align: center;
            color: var(--color-text-muted);
            font-size: 0.95rem;
        }

        footer a {
            color: var(--color-primary-dark);
            text-decoration: none;
            font-weight: 600;
        }

        @media (max-width: 720px) {
            .hero {
                padding: 36px 24px;
            }

            .stage-body {
                padding: 32px 24px;
            }

            .step-card {
                padding: 24px 20px;
            }
        }
    </style>
</head>
<body>
    <div class="page-shell">
        <header>
            <nav class="nav">
                <a class="brand" href="index.html">
                    JTC AI Day ‚Äì Project Runway ‚úàÔ∏è
                </a>
                <div class="nav-links">
                    <a href="index.html#mission-brief">Mission üìã</a>
                    <a href="index.html#agent-features">Agent ü§ñ</a>
                    <a href="stages.html">Stages üõ´</a>
                </div>
            </nav>
        </header>

        <section class="hero">
            <h1>Step 5.3 ¬∑ Integrate Flows into Topic üß©</h1>
            <p>Connect the Generate OTP flow to the Verify Email topic, add OTP verification logic, and integrate it with the conversation start options.</p>
        </section>

        <div class="warning" style="margin: 32px auto 0; max-width: 1100px; background: rgba(255, 140, 0, 0.15); border-left: 6px solid var(--color-accent-orange); padding: 24px 28px; border-radius: var(--radius-md); font-size: 1.05rem; box-shadow: 0 4px 12px rgba(255, 140, 0, 0.2);">
            <strong style="color: var(--color-accent-orange); font-size: 1.1rem;">üìß Important Note:</strong> For users that cannot receive Email OTP via email, you may skip step 6 and 8.
        </div>

        <section class="stage-body">

            <div class="stage-section">
                <h2>Mission Checklist</h2>
                <p>Integrate the Generate OTP flow with the Verify Email topic, add an adaptive card for OTP input, create conditional logic to verify the OTP, and connect it to the conversation start topic.</p>
            </div>

            <article class="step-card">
                <div class="step-header">
                    <div class="step-title">Navigate to Verify Email Topic</div>
                    <span class="step-number">1</span>
                </div>
                <p class="step-text">
                    Let us go back to the <strong>"Verify Email"</strong> topic that we have already created.
                </p>
            </article>

            <article class="step-card">
                <div class="step-header">
                    <div class="step-title">Add Generate OTP Flow as Tool</div>
                    <span class="step-number">2</span>
                </div>
                <p class="step-text">
                    Add a node below the adaptive card: <strong>"Add a tool"</strong> &gt; <strong>"Generate OTP"</strong> flow that we have just created.
                </p>
                <figure>
                    <img src="./Images/Stage 6.3 step 2.png" alt="Add Generate OTP flow as a tool">
                    <figcaption>Add the Generate OTP flow as a tool to the topic.</figcaption>
                </figure>
            </article>

            <article class="step-card">
                <div class="step-header">
                    <div class="step-title">Configure Flow Inputs</div>
                    <span class="step-number">3</span>
                </div>
                <p class="step-text">
                    In the inputs, select the <strong>"username"</strong> and <strong>"useremail"</strong> variables that we will get from the adaptive cards.
                </p>
                <figure>
                    <img src="./Images/Stage 6.3 step 3.png" alt="Configure flow inputs with username and useremail">
                    <figcaption>Map the username and useremail variables from the adaptive card to the flow inputs.</figcaption>
                </figure>
            </article>

            <article class="step-card">
                <div class="step-header">
                    <div class="step-title">Add OTP Input Adaptive Card</div>
                    <span class="step-number">4</span>
                </div>
                <p class="step-text">
                    Add another card node and copy this code into the card editor as you have done previously.
                </p>
                <div class="code-block">{
  "$schema": "http://adaptivecards.io/schemas/adaptive-card.json",
  "type": "AdaptiveCard",
  "version": "1.5",
  "body": [
    {
      "type": "Container",
      "style": "emphasis",
      "bleed": true,
      "items": [
        {
          "type": "TextBlock",
          "text": "üîê Enter Your OTP",
          "weight": "Bolder",
          "size": "Large",
          "color": "Accent",
          "horizontalAlignment": "Center"
        },
        {
          "type": "TextBlock",
          "text": "We've sent a one-time passcode to your email. Please enter it below to continue ‚ú®",
          "wrap": true,
          "spacing": "Small",
          "horizontalAlignment": "Center"
        }
      ]
    },
    {
      "type": "Container",
      "style": "default",
      "bleed": true,
      "items": [
        {
          "type": "TextBlock",
          "text": "üì≤ One-Time Passcode (OTP)",
          "weight": "Bolder",
          "spacing": "Medium"
        },
        {
          "type": "Input.Text",
          "id": "otp",
          "placeholder": "Enter your 6-digit code",
          "maxLength": 6
        }
      ]
    }
  ],
  "actions": [
    {
      "type": "Action.Submit",
      "title": "Verify OTP ‚úÖ",
      "data": {
        "action": "verifyOtp"
      }
    }
  ]
}</div>
            </article>

            <article class="step-card">
                <div class="step-header">
                    <div class="step-title">Verify Adaptive Card Output</div>
                    <span class="step-number">5</span>
                </div>
                <p class="step-text">
                    You should see an adaptive card with 3 outputs like this.
                </p>
                <figure>
                    <img src="./Images/Stage 6.3 step 5.png" alt="Adaptive card with OTP input showing 3 outputs">
                    <figcaption>Verify that the adaptive card displays correctly with the OTP input field.</figcaption>
                </figure>
            </article>

            <article class="step-card">
                <div class="step-header">
                    <div class="step-title">Add Condition Node for OTP Verification</div>
                    <span class="step-number">6</span>
                </div>
                <p class="step-text">
                    Let's add a condition node below the adaptive card. For the first condition, select the <strong>"otp"</strong> variable that the user will input to the adaptive card, and the middle box should contain <strong>"Is equal to"</strong>, then select the value <strong>"OTPCode"</strong> which the flow will be giving us as an output. This will verify the OTP.
                </p>
                <div class="tip" style="margin-top: 16px;">
                    <strong>üí° Note:</strong> For users without work email, use the flow as shown in the image below.
                </div>
                <figure>
                    <img src="./Images/Stage 5.3 step 6.PNG" alt="Flow for users without work email - OTP verification flow">
                    <figcaption>Flow configuration for users without work email - showing OTP input, verification, and success message flow.</figcaption>
                </figure>
            </article>

            <article class="step-card">
                <div class="step-header">
                    <div class="step-title">Configure Success Path</div>
                    <span class="step-number">7</span>
                </div>
                <p class="step-text">
                    Below the <strong>"Condition"</strong> node with your condition, press the <strong>"+"</strong> button and add a message: <strong>"Your Email has been successfully verified!"</strong>, then add another node <strong>"Topic management"</strong> &gt; <strong>"Go to another topic"</strong> &gt; <strong>"Conversation start"</strong>.
                </p>
            </article>

            <article class="step-card">
                <div class="step-header">
                    <div class="step-title">Configure Failure Path</div>
                    <span class="step-number">8</span>
                </div>
                <p class="step-text">
                    Below the <strong>"All other condition"</strong> node, add a <strong>"Message"</strong> node with a message <strong>"Verification failed"</strong> and add another node <strong>"Topic management"</strong> &gt; <strong>"Go to another topic"</strong> &gt; <strong>"Verify Email"</strong>.
                </p>
                <p class="step-text">
                    Your conditions should look like this. Save the topic now.
                </p>
                <figure>
                    <img src="./Images/Stage 6.3 step 7.png" alt="Condition node with success path configured">
                    <figcaption>Configure the success path to show verification message and return to conversation start.</figcaption>
                </figure>
            </article>

            <article class="step-card">
                <div class="step-header">
                    <div class="step-title">Connect to Conversation Start</div>
                    <span class="step-number">9</span>
                </div>
                <p class="step-text">
                    Now we have to go back to our <strong>"Conversation start"</strong> topic on the system topics. Under the condition, <strong>"Var 1 is equal to 'Verify Email ID'"</strong>, let's add a node <strong>"Topic management"</strong> &gt; <strong>"Go to another topic"</strong> &gt; <strong>"Verify Email"</strong>.
                </p>
                <figure>
                    <img src="./Images/Stage 6.3 step 8.png" alt="Complete condition node with both success and failure paths">
                    <figcaption>Configure both success and failure paths for OTP verification.</figcaption>
                </figure>
            </article>

            <article class="step-card">
                <div class="step-header">
                    <div class="step-title">Mission Complete</div>
                    <span class="step-number">10</span>
                </div>
                <p class="step-text">
                    Congratulations! You just integrated the flow to the topic and completed the process to verify email ID!
                </p>
                <div class="tip">
                    The complete 2FA Identity Clearance feature is now integrated. Users can verify their email by receiving an OTP code and entering it through the adaptive card. The system will validate the OTP and either confirm verification or prompt the user to try again.
                </div>
            </article>
        </section>

        <div class="cta-panel">
            <a class="cta-button cta-secondary" href="stage-5-2.html">‚¨ÖÔ∏è Back to Step 5.2</a>
            <a class="cta-button cta-secondary" href="stages.html">üìã Stages Overview</a>
            <a class="cta-button cta-primary" href="stage-6.html">Next Stage ¬∑ Crew ID Setup (BONUS) ‚û°Ô∏è</a>
            <a class="cta-button cta-secondary" href="stage-7.html">Skip to Stage 7 ¬∑ Mission Test</a>
        </div>

        <footer>
            Built for JTC AI Day ¬∑ Nov '25 ‚ú® Powered by Microsoft Copilot Studio ü§ñ<br>
            Hands-on guide/site by Zafir ‚Äî Solution Engineer, Microsoft üöÄ<br>
            Agent demo by Lincoln ‚Äî Solution Engineer, Microsoft üöÄ
        </footer>
    </div>
</body>
</html>

